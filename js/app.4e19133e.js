(function(){"use strict";var e={1141:function(e,t,o){o(987);var n=o(9963),r=o(6252);function l(e,t,o,n,l,a){const i=(0,r.up)("app-main");return(0,r.wg)(),(0,r.j4)(i)}o(7658);var a=o(2262),i=JSON.parse('{"u2":"gogoend-node-link-builder","i8":"0.1.1"}');const s=[];for(let Qo=0;Qo<256;Qo++)s[Qo]=(Qo<16?"0":"")+Qo.toString(16);function u(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,o=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=s[255&e]+s[e>>8&255]+s[e>>16&255]+s[e>>24&255]+"-"+s[255&t]+s[t>>8&255]+"-"+s[t>>16&15|64]+s[t>>24&255]+"-"+s[63&o|128]+s[o>>8&255]+"-"+s[o>>16&255]+s[o>>24&255]+s[255&n]+s[n>>8&255]+s[n>>16&255]+s[n>>24&255];return r.toUpperCase()}function d(e){return null!==e&&"object"===typeof e}const c=(e,t,o)=>{if(d(o))try{o=JSON.stringify(o)}catch{}window[e].setItem(t,o)},p=(e,t)=>{let o=window[e].getItem(t);if(o)try{o=JSON.parse(o)}catch{}return o},f=e=>p("localStorage",e),v=(e,t)=>c("localStorage",e,t),m=Symbol("Canvas上的所有节点"),h=Symbol("添加节点函数"),g=Symbol("移除节点函数"),y=Symbol("Canvas上的所有连线"),P=Symbol("节点对应所有出、入连线的映射关系"),w=Symbol("删除连线函数"),b=Symbol("添加连线函数"),_=Symbol("向 节点id->出、入连线 的映射中添加连线关系"),C=Symbol("Node组件映射"),I=Symbol("保存滤镜函数");function S(){const{$eventHub:e}=(0,r.FN)().appContext.config.globalProperties,t=(0,a.iH)({});(0,r.JJ)(m,t);const o=e=>{t.value[e.id]=e};(0,r.JJ)(h,o);const n=e=>{const t=[...f.value[e]?.in?.map((e=>e.id))??[],...f.value[e]?.out?.map((e=>e.id))??[]];t.forEach((e=>{N(e)})),delete f.value[e]},l=o=>{n(o),delete t.value[o],e.emit("svg-canvas:node-removed",o)};(0,r.JJ)(g,l);const s=(0,a.iH)({});(0,r.JJ)(C,s);const d=(0,r.Fl)((()=>{const e={};return Object.entries(s.value).forEach((([t,o])=>{e[t]=o.nodeConfigRef.feAttrValue})),e})),c=(0,a.iH)({});(0,r.JJ)("tempLinkedPathsForSerialize",c);const p=(0,a.iH)([]);(0,r.JJ)(y,p);const f=(0,a.iH)({});(0,r.JJ)(P,f);const S=e=>{p.value.push(e),c.value[e.id]={id:e.id,from:{vmId:e.from.vm.nodeId,attr:e.from.attr},to:{vmId:e.to.vm.nodeId,attr:e.to.attr}}};(0,r.JJ)(b,S);const N=e=>{const t=p.value.findIndex((t=>t.id===e)),[o]=p.value.splice(t,1);delete c.value[e],Object.values(f.value).forEach((t=>{for(let o=0;o<t.in.length;)t.in[o].id!==e?o++:t.in.splice(o,1);for(let o=0;o<t.out.length;)t.out[o].id!==e?o++:t.out.splice(o,1)})),o.to.vm.afterPathRemoved?.(o)};(0,r.JJ)(w,N);const D=(e,t,o)=>{f.value[(0,a.SU)(t).vm.nodeId]||(f.value[(0,a.SU)(t).vm.nodeId]={in:[],out:[]}),f.value[(0,a.SU)(t).vm.nodeId].out.push(e),f.value[(0,a.SU)(o).vm.nodeId]||(f.value[(0,a.SU)(o).vm.nodeId]={in:[],out:[]}),f.value[(0,a.SU)(o).vm.nodeId].in.push(e)};(0,r.JJ)(_,D);const x=()=>{const e={nodes:t.value,nodeForms:d.value,links:c.value},o={name:i.u2,version:i.i8},n={author:"gogoend",createdTime:Number(new Date),modifiedTime:Number(new Date)};v("savedGraph",{uuid:u(),stuff:e,product:o,document:n})};(0,r.JJ)(I,x)}const N=Symbol("正在拖拽的项目"),D=Symbol("鬼影节点引用");function x(){const e=(0,a.iH)(null);(0,r.JJ)(N,e);const t=(0,a.iH)(null);(0,r.JJ)(D,t)}const E=Symbol("被聚焦的节点");function F(){const e=(0,a.iH)(null),t=t=>{e.value=t},{$eventHub:o}=(0,r.FN)().appContext.config.globalProperties;o.on("svg-canvas:node-removed",(o=>{e.value?.nodeId===o&&t(null)})),(0,r.JJ)(E,[e,t])}const O=Symbol("SvgCanvas组件实例"),V=Symbol("设置SvgCanvas组件实例");function M(){const e=(0,a.XI)();(0,r.JJ)(O,e);const t=t=>{e.value=t};(0,r.JJ)(V,t)}function k(){[S,x,F,M].forEach((e=>e()))}var R=o(3577);const T={class:"app-wrap"};function A(e,t,o,n,l,a){const i=(0,r.up)("top-menu-bar"),s=(0,r.up)("svg-canvas"),u=(0,r.up)("node-library-panel"),d=(0,r.up)("stuff-config-panel"),c=(0,r.up)("output-preview-panel");return(0,r.wg)(),(0,r.iD)("div",T,[(0,r.Wm)(i,{class:"top-menu-bar",style:(0,R.j5)({height:`${e.topMenuBarHeight}px`})},null,8,["style"]),(0,r._)("div",{class:"workbench-wrap",style:(0,R.j5)({top:`${e.topMenuBarHeight}px`})},[(0,r.Wm)(s,{class:"svg-canvas",style:(0,R.j5)({left:e.filterLibraryPanelWidth+"px",width:`calc(100% - ${e.stuffConfigPanelWidth}px - ${e.filterLibraryPanelWidth}px)`}),onVnodeMounted:t[0]||(t[0]=t=>{e.setSvgCanvasVm(t.component.proxy)})},null,8,["style"]),(0,r.Wm)(u,{class:"node-library-panel",style:(0,R.j5)({left:0,right:`calc(100% - ${e.filterLibraryPanelWidth}px)`})},null,8,["style"]),(0,r.Wm)(d,{class:"stuff-config-panel",style:(0,R.j5)({right:0,left:`calc(100% - ${e.stuffConfigPanelWidth}px)`})},null,8,["style"]),(0,r.Wm)(c,{class:"output-preview-panel",style:{width:"640px",height:"360px",bottom:"0px",right:"0px"}})],4)])}const U={ref:"canvasScrollEl"},j={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 4000 4000","xml:space":"preserve",class:"svg-canvas-board"},H={class:"ghost"},G=["d"];function B(e,t,o,n,l,a){const i=(0,r.up)("io-node"),s=(0,r.up)("io-path");return(0,r.wg)(),(0,r.iD)("div",U,[((0,r.wg)(),(0,r.iD)("svg",j,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.nodes,(t=>((0,r.wg)(),(0,r.j4)(i,{ref_for:!0,ref:e.setNodeRefMap,key:t.id,is:t.is,"node-id":t.id,onPortStart:e.handlePortStart,onPortMove:e.handlePortMove,onPortConnect:e.handlePortConnect,onPortCancel:e.handlePortCancel,onDestinationChange:e.handleDestinationChange,"relative-paths":e.relativePathMapIndexedByNodeId[t.id]??e.defaultRelativePath,onNodeMove:e.handleNodeMove,position:t.position,"onUpdate:position":e=>t.position=e},null,8,["is","node-id","onPortStart","onPortMove","onPortConnect","onPortCancel","onDestinationChange","relative-paths","onNodeMove","position","onUpdate:position"])))),128)),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.linkedPaths,(t=>((0,r.wg)(),(0,r.j4)(s,{key:t.id,"path-id":t.id,"path-d-arguments":t.pathDArguments,from:t.from,to:t.to,onRemove:e.removePath},null,8,["path-id","path-d-arguments","from","to","onRemove"])))),128)),(0,r._)("g",H,[(0,r._)("path",{class:"ghost-path",d:e.ghostPathD},null,8,G),e.ghostNodeType?((0,r.wg)(),(0,r.j4)(i,{key:0,ref:"ghostNodeRef",style:{opacity:"0.5"},is:e.ghostNodeType,nodeId:"0",position:e.ghostNodePosition,"onUpdate:position":t[0]||(t[0]=t=>e.ghostNodePosition=t),relativePaths:e.defaultRelativePath},null,8,["is","position","relativePaths"])):(0,r.kq)("",!0)])]))],512)}o(2801),o(1295);const J=["transform"],$={class:"io-node__inner"},q={class:"io-node__head"},W={transform:"matrix(1 0 0 1 0 8)",class:"fill-fff module-name"},L={class:"io-node__toolbox"};function Z(e,t,o,l,a,i){const s=(0,r.up)("normal-node"),u=(0,r.up)("merge-node"),d=(0,r.up)("source-node"),c=(0,r.up)("string-literal-node"),p=(0,r.up)("matrix-in-fe-color-matrix-node"),f=(0,r.up)("component-transfer-root-node"),v=(0,r.up)("component-transfer-child-node");return(0,r.wg)(),(0,r.iD)("g",{class:(0,R.C_)(["io-node",{"io-node--focused":e.isFocused}]),onMousedown:t[3]||(t[3]=(0,n.iM)(((...t)=>e.handleNodeMousedown&&e.handleNodeMousedown(...t)),["stop"])),transform:`translate(${e.position[0]}, ${e.position[1]})`,ref:"ioNodeEl"},[((0,r.wg)(),(0,r.iD)("foreignObject",$,[(0,r._)("div",{class:"io-node__body",xmlns:"http://www.w3.org/1999/xhtml",onClick:t[2]||(t[2]=(0,n.iM)(((...t)=>e.handleNodeBodyClick&&e.handleNodeBodyClick(...t)),["exact","stop"]))},[(0,r.kq)("",!0),(0,r._)("div",q,[(0,r._)("em",{class:"port out","data-port-type":"out",style:(0,R.j5)({width:2*e.POINT_R+"px",height:2*e.POINT_R+"px",borderWidth:`${e.POINT_BORDER_W}px`}),"data-fe-attr":"result",ref:e.setFeAttrEls,onMouseenter:t[0]||(t[0]=(...t)=>e.handlePortMouseenter&&e.handlePortMouseenter(...t))},null,36),(0,r._)("span",W,(0,R.zw)(e.is),1)]),["normal",void 0].includes(e.fe[e.is].type)?((0,r.wg)(),(0,r.j4)(s,{key:1,is:e.is,"node-id":e.nodeId,relativePaths:e.relativePaths,ref:"nodeConfigRef"},null,8,["is","node-id","relativePaths"])):["merge"].includes(e.fe[e.is].type)?((0,r.wg)(),(0,r.j4)(u,{key:2,is:e.is,"node-id":e.nodeId,relativePaths:e.relativePaths,ref:"nodeConfigRef"},null,8,["is","node-id","relativePaths"])):["source"].includes(e.fe[e.is].type)?((0,r.wg)(),(0,r.j4)(d,{key:3,is:e.is,"node-id":e.nodeId,relativePaths:e.relativePaths,ref:"nodeConfigRef"},null,8,["is","node-id","relativePaths"])):["string-literal"].includes(e.fe[e.is].type)?((0,r.wg)(),(0,r.j4)(c,{key:4,is:e.is,"node-id":e.nodeId,relativePaths:e.relativePaths,ref:"nodeConfigRef"},null,8,["is","node-id","relativePaths"])):["matrix-in-fe-color-matrix"].includes(e.fe[e.is].type)?((0,r.wg)(),(0,r.j4)(p,{key:5,is:e.is,"node-id":e.nodeId,relativePaths:e.relativePaths,ref:"nodeConfigRef"},null,8,["is","node-id","relativePaths"])):["component-transfer-root"].includes(e.fe[e.is].type)?((0,r.wg)(),(0,r.j4)(f,{key:6,is:e.is,"node-id":e.nodeId,relativePaths:e.relativePaths,ref:"nodeConfigRef"},null,8,["is","node-id","relativePaths"])):["component-transfer-child"].includes(e.fe[e.is].type)?((0,r.wg)(),(0,r.j4)(v,{key:7,is:e.is,"node-id":e.nodeId,relativePaths:e.relativePaths,ref:"nodeConfigRef"},null,8,["is","node-id","relativePaths"])):(0,r.kq)("",!0),(0,r._)("div",L,[(0,r._)("button",{onClick:t[1]||(t[1]=t=>e.removeNode(e.nodeId))},"删除节点")])])]))],42,J)}const Y=function(e,t){const o=t?.start||(()=>{}),n=t?.move||(()=>{}),r=t?.up||(()=>{}),l=e.target;o(e,{originEl:l});const a=e=>{switch(e.type){case"mousemove":n(e,{originEl:l});break;case"mouseup":document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",a),r(e,{originEl:l});break}};document.addEventListener("mousemove",a),document.addEventListener("mouseup",a)};var X=Y;const K={type:"source",ports:{}},z={type:"source",ports:{}},Q={type:"normal",ports:{in:{showInConfigPanel:!1},kernelMatrix:{defaultValue:"0 1 0, 1 1 1, 0 1 0"},order:{defaultValue:"3, 3"},divisor:{type:"number",defaultValue:1},bias:{type:"number",range:[0,1],defaultValue:0},targetX:{type:"number",defaultValue:0},targetY:{type:"number",defaultValue:0},edgeMode:{type:"text",defaultValue:"duplicate",enum:["duplicate","wrap","none"]},kernelUnitLength:{type:"number",defaultValue:2},preserveAlpha:{type:"text",defaultValue:"true",enum:["true","false"]}}},ee={type:"normal",ports:{type:{type:"text",defaultValue:"fractalNoise",enum:[{label:"fractalNoise",value:"fractalNoise"},{label:"turbulence",value:"turbulence"}]},baseFrequency:{type:"number",defaultValue:.05},numOctaves:{type:"number",defaultValue:0,range:[0,100]},stitchTiles:{defaultValue:"stitch",enum:["stitch","noStitch"]},seed:{type:"number",defaultValue:.05}}},te={type:"normal",ports:{in:{showInConfigPanel:!1},dx:{type:"number"},dy:{type:"number"},stdDeviation:{type:"number"},seed:{},"flood-color":{},"flood-opacity":{}}},oe={type:"merge",ports:{in:{showInConfigPanel:!1}}},ne={type:"normal",ports:{in:{showInConfigPanel:!1},dx:{type:"number"},dy:{type:"number"}}},re={type:"normal",tag:"feColorMatrix",ports:{in:{showInConfigPanel:!1},type:{showInConfigPanel:!1,showOnNode:!1,defaultValue:"matrix"},values:{defaultValue:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0].join(" ")}}},le={type:"matrix-in-fe-color-matrix",ports:{}},ae={tag:"feColorMatrix",type:"normal",ports:{in:{showInConfigPanel:!1},type:{showInConfigPanel:!1,showOnNode:!1,defaultValue:"saturate"},values:{defaultValue:"1"}}},ie={tag:"feColorMatrix",type:"normal",ports:{in:{showInConfigPanel:!1},type:{showInConfigPanel:!1,showOnNode:!1,defaultValue:"hueRotate"},values:{defaultValue:"0"}}},se={tag:"feColorMatrix",type:"normal",ports:{in:{showInConfigPanel:!1},type:{showInConfigPanel:!1,showOnNode:!1,defaultValue:"luminanceToAlpha"},values:{}}},ue={type:"normal",ports:{in:{showInConfigPanel:!1}}},de={type:"normal",ports:{in:{showInConfigPanel:!1},in2:{showInConfigPanel:!1},scale:{},xChannelSelector:{},yChannelSelector:{}}},ce={type:"normal",ports:{href:{}}},pe={type:"normal",ports:{in:{showInConfigPanel:!1},in2:{showInConfigPanel:!1},mode:{defaultValue:"normal",enum:["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}}},fe={type:"normal",tag:"feComposite",ports:{in:{showInConfigPanel:!1},in2:{showInConfigPanel:!1},operator:{enum:["over","in","out","atop","xor","lighter"]}}},ve={type:"normal",tag:"feComposite",ports:{in:{showInConfigPanel:!1},in2:{showInConfigPanel:!1},operator:{showInConfigPanel:!1,showOnNode:!1,defaultValue:"arithmetic"},k1:{type:"number",defaultValue:.5},k2:{type:"number",defaultValue:.5},k3:{type:"number",defaultValue:.5},k4:{type:"number",defaultValue:.5}}},me={type:"normal",ports:{"flood-color":{},"flood-opacity":{type:"number"}}},he={type:"normal",ports:{in:{showInConfigPanel:!1},stdDeviation:{type:"number"},edgeMode:{type:"text",enum:["duplicate","wrap","none"],defaultValue:"none"}}},ge={type:"normal",ports:{in:{showInConfigPanel:!1},operator:{enum:["erode","dilate"],defaultValue:"erode"},radius:{type:"number",defaultValue:2}}},ye={type:"component-transfer-root",ports:{in:{showInConfigPanel:!1},R:{showInConfigPanel:!1},G:{showInConfigPanel:!1},B:{showInConfigPanel:!1},A:{showInConfigPanel:!1}}},Pe={type:"component-transfer-child",ports:{type:{defaultValue:"identity",showInConfigPanel:!1,showOnNode:!1}}},we={type:"component-transfer-child",ports:{type:{defaultValue:"table",showInConfigPanel:!1,showOnNode:!1},tableValues:{defaultValue:"1 1 1 1"}}},be={type:"component-transfer-child",ports:{type:{defaultValue:"linear",enum:["linear","discrete"]},slope:{type:"number",defaultValue:1},intercept:{type:"number",defaultValue:0}}},_e={type:"component-transfer-child",ports:{type:{defaultValue:"gamma",showInConfigPanel:!1,showOnNode:!1},amplitude:{type:"number",defaultValue:1},exponent:{type:"number",defaultValue:0},offset:{type:"number",defaultValue:0}}},Ce={type:"string-literal",ports:{value:{type:"text"}}};var Ie={SourceGraphic:K,SourceAlpha:z,feConvolveMatrix:Q,feTurbulence:ee,feDropShadow:te,feMerge:oe,feOffset:ne,feColorMatrixUsingMatrix:re,matrixInFeColorMatrix:le,feColorMatrixUsingSaturate:ae,feColorMatrixUsingHueRotate:ie,feColorMatrixUsingLuminanceToAlpha:se,feTile:ue,feDisplacementMap:de,feImage:ce,feBlend:pe,feCompositeWithoutK:fe,feCompositeWithK:ve,feFlood:me,feGaussianBlur:he,feMorphology:ge,feComponentTransfer:ye,feFuncXUsingIdentity:Pe,feFuncXUsingTable:we,feFuncXUsingLinearOrDiscrete:be,feFuncXUsingGamma:_e,StringLiteral:Ce};const Se=Symbol("SvgCanvas组件的范围");function Ne(e){return e.dataset.portType}function De(e){return["in","out"].includes(e.dataset.portType)}function xe(e){const{props:t,type:o}=e;let n=e.children;const r=document.createElementNS("http://www.w3.org/2000/svg",o);return t&&Object.keys(t).forEach((e=>{["number","string"].includes(typeof t?.[e])&&String(t?.[e]).length&&r.setAttribute(e,t?.[e])})),"object"===typeof n&&null!==n?Array.isArray(n)||(n=[n]):n=[],(n||[]).forEach((e=>{r.append(xe(e))})),r}const Ee=e=>{const t=new Map,o=new Map;e.forEach((e=>{const[n,r]=[e.from.vm,e.to.vm];t.has(n)||(t.set(n,0),o.set(n,[])),t.has(r)||(t.set(r,0),o.set(r,[])),t.set(r,t.get(r)+1),o.get(n).push(r)}));const n=[],r=[];for(const l of t)0===l[1]&&n.push(l[0]);while(n.length){const e=n.shift();r.push(e);const l=o.get(e);l.forEach((e=>{t.set(e,t.get(e)-1),0===t.get(e)&&n.push(e)}))}return r},Fe=(...e)=>{},Oe={key:0,class:"io-node__li"},Ve=["data-fe-attr"],Me={class:"io-node__port-text"},ke={class:"port-name"};function Re(e,t,o,n,l,a){return(0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.fe[e.is].ports,((o,n)=>((0,r.wg)(),(0,r.iD)(r.HY,{key:n},[!1!==o.showOnNode?((0,r.wg)(),(0,r.iD)("div",Oe,[(0,r._)("em",{class:"port in",style:(0,R.j5)({width:2*e.POINT_R+"px",height:2*e.POINT_R+"px",borderWidth:`${e.POINT_BORDER_W}px`}),"data-port-type":"in",r:"10","data-fe-attr":n,ref_for:!0,ref:e.setFeAttrEls,onMouseenter:t[0]||(t[0]=(...t)=>e.handlePortMouseenter&&e.handlePortMouseenter(...t))},null,44,Ve),(0,r._)("label",Me,[(0,r._)("span",ke,(0,R.zw)(n),1)])])):(0,r.kq)("",!0)],64)))),128)}var Te=()=>{const e=(0,r.f3)("fromPort"),t=(0,r.f3)("toPort"),o=(0,a.iH)(),n=(0,a.iH)([]),l=e=>{e&&n.value.push(e)};(0,r.Xn)((()=>{n.value=[]}));const i=(0,r.f3)("allDescendants"),s=(0,r.f3)("orderedAllDescendants"),u=(0,r.f3)("handlePortMouseenter"),d=(0,r.Fl)((()=>{const e="data:image/svg+xml,",t=(0,r.h)("filter",{id:"filter"},(s?.value??[]).map(((e,t)=>e.getVNodeFragment(e,t)))),o=`\n<svg xmlns="http://www.w3.org/2000/svg" id="SVGFilter" width="40" height="40" viewBox="0 0 256 256">\n<defs>${xe(t).outerHTML}</defs>\n<g filter="url(#filter)">\n  <linearGradient id="SVGID_1_" gradientUnits="userSpaceOnUse" x1="0" y1="64" x2="64" y2="64">\n    <stop offset="0" style="stop-color:#EE7E77" /><stop offset="0.5" style="stop-color:#E7334C" /><stop offset="1" style="stop-color:#DA0439" />\n  </linearGradient>\n  <rect style="fill:url(#SVGID_1_);" width="64" height="128" />\n  <linearGradient id="SVGID_2_" gradientUnits="userSpaceOnUse" x1="64" y1="64" x2="128" y2="64">\n    <stop offset="0" style="stop-color:#F29847" /><stop offset="0.5" style="stop-color:#EE7300" /><stop offset="1" style="stop-color:#D45E12" />\n  </linearGradient>\n  <rect x="64" style="fill:url(#SVGID_2_);" width="64" height="128" />\n  <linearGradient id="SVGID_3_" gradientUnits="userSpaceOnUse" x1="128" y1="64" x2="192" y2="64">\n    <stop offset="0" style="stop-color:#FFF9AC" /><stop offset="0.5" style="stop-color:#FFF000" /><stop offset="1" style="stop-color:#FFDC00" />\n  </linearGradient>\n  <rect x="128" style="fill:url(#SVGID_3_);" width="64" height="128" />\n  <linearGradient id="SVGID_4_" gradientUnits="userSpaceOnUse" x1="192" y1="64" x2="256" y2="64">\n    <stop offset="0" style="stop-color:#66BC81" /><stop offset="0.5" style="stop-color:#009944" /><stop offset="1" style="stop-color:#008A43" />\n  </linearGradient>\n  <rect x="192" style="fill:url(#SVGID_4_);" width="64" height="128" />\n  <linearGradient id="SVGID_5_" gradientUnits="userSpaceOnUse" x1="0" y1="192" x2="64" y2="192">\n    <stop offset="0" style="stop-color:#3EAFCD" /><stop offset="0.5" style="stop-color:#0091B8" /><stop offset="1" style="stop-color:#00767F" />\n  </linearGradient>\n  <rect y="128" style="fill:url(#SVGID_5_);" width="64" height="128" />\n  <linearGradient id="SVGID_6_" gradientUnits="userSpaceOnUse" x1="64" y1="192" x2="128" y2="192">\n    <stop offset="0" style="stop-color:#584C9D" /><stop offset="0.5" style="stop-color:#1D2088" /><stop offset="1" style="stop-color:#39396C" />\n  </linearGradient>\n  <rect x="64" y="128" style="fill:url(#SVGID_6_);" width="64" height="128" />\n  <linearGradient id="SVGID_7_" gradientUnits="userSpaceOnUse" x1="128" y1="192" x2="192" y2="192">\n    <stop offset="0" style="stop-color:#B87FB5" /><stop offset="0.5" style="stop-color:#8E2E8C" /><stop offset="1" style="stop-color:#731485" />\n  </linearGradient>\n  <rect x="128" y="128" style="fill:url(#SVGID_7_);" width="64" height="128" />\n  <linearGradient id="SVGID_8_" gradientUnits="userSpaceOnUse" x1="192" y1="192" x2="256" y2="192">\n    <stop offset="0" style="stop-color:#EB70A6" /><stop offset="0.5" style="stop-color:#E4007F" /><stop offset="1" style="stop-color:#CE0080" />\n  </linearGradient>\n  <rect x="192" y="128" style="fill:url(#SVGID_8_);" width="64" height="128" />\n</g>\n</svg>\n`;return e+encodeURIComponent(o)}));return{fromPort:e,toPort:t,ioNodeEl:o,feAttrEls:n,setFeAttrEls:l,allDescendants:i,handlePortMouseenter:u,filterThumbUrl:d}};const Ae=150,Ue=300,je=32,He=10,Ge=4,Be=150,Je=4;var $e=(0,r.aZ)({name:"NormalNode",props:{is:{type:String,required:!0},nodeId:{type:String,required:!0},relativePaths:{type:Object,required:!0}},setup(e){const{fromPort:t,toPort:o,ioNodeEl:n,setFeAttrEls:l,allDescendants:i,handlePortMouseenter:s,filterThumbUrl:u}=Te(),d=(0,a.iH)({}),c=(0,r.Fl)((()=>{const t={};return e.relativePaths.in.forEach((e=>{t[e.to.attr]=e.from.vm.mergedFeAttrValue[e.from.attr]})),t})),p=(0,r.Fl)((()=>({...d.value,...c.value,result:e.nodeId}))),f=(e,t)=>{const o=e.is,{mergedFeAttrValue:n}=e,l={};Object.keys(n||{}).forEach((e=>{void 0!==n[e]&&(l[e]=n[e]||""),l.in===l.result&&delete l.in,Object.prototype.hasOwnProperty.call(Ie[o].ports,"in")&&!l.in&&(l.in="SourceGraphic"),Object.prototype.hasOwnProperty.call(Ie[o].ports,"in2")&&!l.in2&&(l.in2="SourceGraphic")}));const a=Ie[o].tag??o;return(0,r.h)(a,l)};if(console.log(Ie[e.is]),["normal",void 0].includes(Ie[e.is].type)){const{ports:t}=Ie[e.is];Object.keys(t).forEach((e=>{["number","range"].includes(t[e].type)?d.value[e]=t[e].defaultValue??0:d.value[e]=t[e].defaultValue??""}))}return{POINT_R:He,POINT_BORDER_W:Ge,fromPort:t,ioNodeEl:n,setFeAttrEls:l,feAttrValue:d,foreignPortValue:c,mergedFeAttrValue:p,afterPathConnected:Fe,afterPathRemoved:Fe,handlePortMouseenter:s,fe:Ie,allDescendants:i,filterThumbUrl:u,getVNodeFragment:f}}}),qe=o(3744);const We=(0,qe.Z)($e,[["render",Re],["__scopeId","data-v-a33413f4"]]);var Le=We;const Ze=e=>((0,r.dD)("data-v-5b8cb670"),e=e(),(0,r.Cn)(),e),Ye=["data-fe-attr"],Xe=Ze((()=>(0,r._)("label",{class:"io-node__port-text"},[(0,r._)("span",{class:"port-name"},"in")],-1)));function Ke(e,t,o,n,l,a){return(0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.feAttrValue,((o,n)=>((0,r.wg)(),(0,r.iD)("div",{class:"io-node__li",key:n},[(0,r._)("em",{class:"port in",style:(0,R.j5)({width:2*e.POINT_R+"px",height:2*e.POINT_R+"px",borderWidth:`${e.POINT_BORDER_W}px`}),"data-port-type":"in",r:"10","data-fe-attr":n,ref_for:!0,ref:e.setFeAttrEls,onMouseenter:t[0]||(t[0]=(...t)=>e.handlePortMouseenter&&e.handlePortMouseenter(...t))},null,44,Ye),Xe])))),128)}var ze=(0,r.aZ)({name:"MergeNode",props:{is:{type:String,required:!0},nodeId:{type:String,required:!0},relativePaths:{type:Object,required:!0}},setup(e){const{toPort:t,fromPort:o,ioNodeEl:n,setFeAttrEls:l,allDescendants:i,handlePortMouseenter:s,filterThumbUrl:u}=Te(),d=(0,a.iH)([""]),c=(0,r.Fl)((()=>({result:e.nodeId}))),p=(0,r.FN)().parent?.proxy,f=()=>{console.log(t?.value,o?.value);const{attr:e}=[t?.value,o?.value].find((e=>e?.vm===p)),n=Number(e);d.value[n]=o.value.vm.nodeId,d.value[n+1]||(d.value[n+1]="")},v=e=>{const{attr:t}=e.to;d.value[Number(t)]=""},m=()=>{const{is:t,nodeId:o}=e;return(0,r.h)(t,{result:o},(0,a.SU)(d).filter((e=>!!e)).map((e=>(0,r.h)("feMergeNode",{in:e}))))};return{POINT_R:He,POINT_BORDER_W:Ge,fromPort:o,ioNodeEl:n,setFeAttrEls:l,feAttrValue:d,mergedFeAttrValue:c,afterPathConnected:f,afterPathRemoved:v,handlePortMouseenter:s,allDescendants:i,filterThumbUrl:u,getVNodeFragment:m}}});const Qe=(0,qe.Z)(ze,[["render",Ke],["__scopeId","data-v-5b8cb670"]]);var et=Qe;function tt(e,t,o,n,l,a){return(0,r.wg)(),(0,r.iD)("div")}var ot=(0,r.aZ)({name:"SourceNode",props:{is:{type:String,required:!0},nodeId:{type:String,required:!0},relativePaths:{type:Object,required:!0}},setup(e){const{fromPort:t,ioNodeEl:o,setFeAttrEls:n,handlePortMouseenter:l,filterThumbUrl:i}=Te(),s=(0,a.OT)({result:e.is}),u=()=>(0,r.h)("feOffset",{in:e.is});return{POINT_R:He,POINT_BORDER_W:Ge,fromPort:t,ioNodeEl:o,setFeAttrEls:n,mergedFeAttrValue:s,handlePortMouseenter:l,filterThumbUrl:i,getVNodeFragment:u}}});const nt=(0,qe.Z)(ot,[["render",tt],["__scopeId","data-v-4ebf66e6"]]);var rt=nt;function lt(e,t,o,l,a,i){return(0,r.wy)(((0,r.wg)(),(0,r.iD)("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.feAttrValue.value=t)},null,512)),[[n.nr,e.feAttrValue.value,void 0,{lazy:!0}]])}var at=(0,r.aZ)({name:"SourceNode",props:{is:{type:String,required:!0},nodeId:{type:String,required:!0},relativePaths:{type:Object,required:!0}},setup(e){const{fromPort:t,ioNodeEl:o,setFeAttrEls:n,handlePortMouseenter:l,filterThumbUrl:i}=Te(),s=(0,a.iH)({value:""}),u=(0,r.Fl)((()=>({result:(0,a.SU)(s).value}))),d=()=>null;return{POINT_R:He,POINT_BORDER_W:Ge,fromPort:t,ioNodeEl:o,setFeAttrEls:n,mergedFeAttrValue:u,handlePortMouseenter:l,filterThumbUrl:i,getVNodeFragment:d,feAttrValue:s}}});const it=(0,qe.Z)(at,[["render",lt],["__scopeId","data-v-68f4c358"]]);var st=it;const ut=["onUpdate:modelValue"];function dt(e,t,o,l,a,i){return(0,r.wg)(),(0,r.iD)("div",null,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.feAttrValue,((t,o)=>(0,r.wy)(((0,r.wg)(),(0,r.iD)("input",{key:o,"onUpdate:modelValue":t=>e.feAttrValue[o]=t,class:"input"},null,8,ut)),[[n.nr,e.feAttrValue[o]]]))),128))])}var ct=(0,r.aZ)({name:"SourceNode",props:{is:{type:String,required:!0},nodeId:{type:String,required:!0},relativePaths:{type:Object,required:!0}},setup(e){const{fromPort:t,ioNodeEl:o,setFeAttrEls:n,handlePortMouseenter:l,filterThumbUrl:i}=Te(),s=(0,a.iH)((()=>{const e=new Array(20);return e.fill(0),e[0]=e[6]=e[12]=e[18]=1,e})()),u=(0,r.Fl)((()=>({result:s.value.join(" ")}))),d=()=>null;return{POINT_R:He,POINT_BORDER_W:Ge,fromPort:t,ioNodeEl:o,setFeAttrEls:n,feAttrValue:s,mergedFeAttrValue:u,handlePortMouseenter:l,filterThumbUrl:i,getVNodeFragment:d}}});const pt=(0,qe.Z)(ct,[["render",dt],["__scopeId","data-v-f802b5d6"]]);var ft=pt;const vt={key:0,class:"io-node__li"},mt=["data-fe-attr"],ht={class:"io-node__port-text"},gt={class:"port-name"};function yt(e,t,o,n,l,a){return(0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.fe[e.is].ports,((o,n)=>((0,r.wg)(),(0,r.iD)(r.HY,{key:n},[!1!==o.showOnNode?((0,r.wg)(),(0,r.iD)("div",vt,[(0,r._)("em",{class:"port in",style:(0,R.j5)({width:2*e.POINT_R+"px",height:2*e.POINT_R+"px",borderWidth:`${e.POINT_BORDER_W}px`}),"data-port-type":"in",r:"10","data-fe-attr":n,ref_for:!0,ref:e.setFeAttrEls,onMouseenter:t[0]||(t[0]=(...t)=>e.handlePortMouseenter&&e.handlePortMouseenter(...t))},null,44,mt),(0,r._)("label",ht,[(0,r._)("span",gt,(0,R.zw)(n),1)])])):(0,r.kq)("",!0)],64)))),128)}var Pt=(0,r.aZ)({name:"NormalNode",props:{is:{type:String,required:!0},nodeId:{type:String,required:!0},relativePaths:{type:Object,required:!0}},setup(e){const{fromPort:t,toPort:o,ioNodeEl:n,setFeAttrEls:l,allDescendants:i,handlePortMouseenter:s,filterThumbUrl:u}=Te(),d=(0,a.iH)({}),c=(0,r.Fl)((()=>{const t={};return e.relativePaths.in.forEach((e=>{t[e.to.attr]=e.from.vm.mergedFeAttrValue[e.from.attr]})),t})),p=(0,r.Fl)((()=>({in:c.value.in,result:e.nodeId}))),f=(0,r.f3)(C),v=e=>{const t=e.is,{mergedFeAttrValue:o}=e,n={};Object.keys(o||{}).forEach((e=>{void 0!==o[e]&&(n[e]=o[e]||""),n.in===n.result&&delete n.in,Object.prototype.hasOwnProperty.call(Ie[t].ports,"in")&&!n.in&&(n.in="SourceGraphic"),Object.prototype.hasOwnProperty.call(Ie[t].ports,"in2")&&!n.in2&&(n.in2="SourceGraphic")}));const l=Ie[t].tag??t,a={R:{type:"identity"},G:{type:"identity"},B:{type:"identity"},A:{type:"identity"}};return Object.keys(a).forEach((e=>{c.value[e]&&Object.assign(a[e],f.value[c.value[e]].mergedFeAttrValue)})),(0,r.h)(l,n,Object.entries(a).map((([e,t])=>(0,r.h)(`feFunc${e}`,t))))};if(console.log(Ie[e.is]),["normal",void 0].includes(Ie[e.is].type)){const{ports:t}=Ie[e.is];Object.keys(t).forEach((e=>{["number","range"].includes(t[e].type)?d.value[e]=t[e].defaultValue??0:d.value[e]=t[e].defaultValue??""}))}return{POINT_R:He,POINT_BORDER_W:Ge,fromPort:t,ioNodeEl:n,setFeAttrEls:l,feAttrValue:d,foreignPortValue:c,mergedFeAttrValue:p,afterPathConnected:Fe,afterPathRemoved:Fe,handlePortMouseenter:s,fe:Ie,allDescendants:i,filterThumbUrl:u,getVNodeFragment:v}}});const wt=(0,qe.Z)(Pt,[["render",yt],["__scopeId","data-v-2544a775"]]);var bt=wt;const _t={key:0,class:"io-node__li"},Ct=["data-fe-attr"],It={class:"io-node__port-text"},St={class:"port-name"};function Nt(e,t,o,n,l,a){return(0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.fe[e.is].ports,((o,n)=>((0,r.wg)(),(0,r.iD)(r.HY,{key:n},[!1!==o.showOnNode?((0,r.wg)(),(0,r.iD)("div",_t,[(0,r._)("em",{class:"port in",style:(0,R.j5)({width:2*e.POINT_R+"px",height:2*e.POINT_R+"px",borderWidth:`${e.POINT_BORDER_W}px`}),"data-port-type":"in",r:"10","data-fe-attr":n,ref_for:!0,ref:e.setFeAttrEls,onMouseenter:t[0]||(t[0]=(...t)=>e.handlePortMouseenter&&e.handlePortMouseenter(...t))},null,44,Ct),(0,r._)("label",It,[(0,r._)("span",St,(0,R.zw)(n),1)])])):(0,r.kq)("",!0)],64)))),128)}var Dt=(0,r.aZ)({name:"NormalNode",props:{is:{type:String,required:!0},nodeId:{type:String,required:!0},relativePaths:{type:Object,required:!0}},setup(e){const{fromPort:t,toPort:o,ioNodeEl:n,setFeAttrEls:l,allDescendants:i,handlePortMouseenter:s,filterThumbUrl:u}=Te(),d=(0,a.iH)({}),c=(0,r.Fl)((()=>{const t={};return e.relativePaths.in.forEach((e=>{t[e.to.attr]=e.from.vm.mergedFeAttrValue[e.from.attr]})),t})),p=(0,r.Fl)((()=>({type:Ie[e.is].ports.type.defaultValue,...d.value,...c.value,result:e.nodeId}))),f=()=>null;if(console.log(Ie[e.is]),["normal",void 0].includes(Ie[e.is].type)){const{ports:t}=Ie[e.is];Object.keys(t).forEach((e=>{["number","range"].includes(t[e].type)?d.value[e]=t[e].defaultValue??0:d.value[e]=t[e].defaultValue??""}))}return{POINT_R:He,POINT_BORDER_W:Ge,fromPort:t,ioNodeEl:n,setFeAttrEls:l,feAttrValue:d,foreignPortValue:c,mergedFeAttrValue:p,afterPathConnected:Fe,afterPathRemoved:Fe,handlePortMouseenter:s,fe:Ie,allDescendants:i,filterThumbUrl:u,getVNodeFragment:f}}});const xt=(0,qe.Z)(Dt,[["render",Nt],["__scopeId","data-v-7bcbc2da"]]);var Et=xt;const Ft=(0,r.aZ)({components:{NormalNode:Le,MergeNode:et,SourceNode:rt,StringLiteralNode:st,MatrixInFeColorMatrixNode:ft,ComponentTransferRootNode:bt,ComponentTransferChildNode:Et},name:"IoNode",props:{is:{type:String,required:!0},nodeId:{type:String,required:!0},relativePaths:{type:Object,required:!0},position:{type:Array,required:!0}},setup(e,{emit:t}){const o=(0,r.FN)().proxy,n=(0,r.f3)(Se),l=(0,r.f3)("fromPort"),i=(0,r.f3)("toPort"),s=(0,a.iH)(),u=(0,a.iH)([0,0]),d=(0,a.iH)([]),c=e=>{e&&d.value.push(e)};(0,r.Xn)((()=>{d.value=[]}));const p=(0,a.iH)(),f=(0,r.Fl)((()=>p.value?.filterThumbUrl??"")),v=(0,r.Fl)((()=>p.value?.mergedFeAttrValue??{})),m=(0,r.Fl)((()=>p.value?.getVNodeFragment)),h=(0,r.Fl)((()=>p.value?.afterPathConnected??(()=>{}))),y=(0,r.Fl)((()=>p.value?.afterPathRemoved??(()=>{}))),P=(0,r.f3)("canvasScrollEl"),w=function(a){X(a,{start(e,{originEl:n}){if(De(n))t("port-start",{ev:e,originEl:n,vm:o});else{const t=s.value?.getBoundingClientRect();u.value=[e.pageX-t?.left-P.value.scrollLeft,e.pageY-t?.top-P.value.scrollTop]}},move(l,{originEl:a}){if(De(a))t("port-move",{ev:l,originEl:a,vm:o});else{const o=[l.pageX-u.value[0]-n.value.left,l.pageY-u.value[1]-n.value.top];t("update:position",o),(0,r.Y3)((()=>{const o=s.value?.getBoundingClientRect();u.value=[l.pageX-o?.left-P.value.scrollLeft,l.pageY-o?.top-P.value.scrollTop],t("node-move",e.relativePaths)}))}},up(e,{originEl:n}){De(n)&&(De(e.target)&&l?.value&&i?.value?t("port-connect",{ev:e,originEl:n,vm:o}):t("port-cancel",{ev:e,originEl:n,vm:o})),u.value=[0,0]}})},b=function(e){l?.value&&(t("destination-change",{ev:e,vm:null,originEl:null}),e.target?.removeEventListener("mouseout",b))},_=function(e){l?.value&&(t("destination-change",{ev:e,vm:o,originEl:e.target}),e.target?.addEventListener("mouseout",b))};(0,r.JJ)("handlePortMouseenter",_);const C=(0,r.Fl)((()=>{const e=new Set,t=o=>{e.add(o),o.relativePaths.in.forEach((e=>{t(e.from.vm)}))};return t(o),[...e]}));(0,r.JJ)("allDescendants",C);const I=(0,r.Fl)((()=>{const e=[];return C?.value.forEach((t=>{e.push(...t.relativePaths.in)})),e.length?Ee(e):[o]}));(0,r.JJ)("orderedAllDescendants",I);const[S,N]=(0,r.f3)(E),D=()=>{N(o)},x=(0,r.Fl)((()=>S.value===o)),F=(0,r.f3)(g);return{POINT_R:He,POINT_BORDER_W:Ge,fromPort:l,ioNodeEl:s,setFeAttrEls:c,handleNodeMousedown:w,handlePortMouseenter:_,fe:Ie,allDescendants:C,afterPathConnected:h,afterPathRemoved:y,nodeConfigRef:p,filterThumbUrl:f,mergedFeAttrValue:v,getVNodeFragment:m,orderedAllDescendants:I,focusingNode:S,handleNodeBodyClick:D,isFocused:x,removeNode:F}}});var Ot=Ft;const Vt=(0,qe.Z)(Ot,[["render",Z],["__scopeId","data-v-421e96c7"]]);var Mt=Vt;const kt=["d"],Rt={key:0,class:"linked-path-tools"},Tt=["cx","cy"];function At(e,t,o,n,l,a){return(0,r.wg)(),(0,r.iD)("g",{class:(0,R.C_)(["linked-path",{"linked-path__focused":e.focused}]),onFocus:t[2]||(t[2]=t=>e.focused=!0),onBlur:t[3]||(t[3]=t=>e.focused=!1)},[(0,r._)("path",{class:(0,R.C_)(["linked-path-path",{"linked-path__focused-path":e.focused}]),style:(0,R.j5)({strokeWidth:`${e.PATH_STROKE_W}px`}),d:e.pathD,onClick:t[0]||(t[0]=(...t)=>e.handlePathClick&&e.handlePathClick(...t)),ref:"pathRef"},null,14,kt),e.focused?((0,r.wg)(),(0,r.iD)("g",Rt,[(0,r._)("circle",{r:"10",cx:e.p[0],cy:e.p[1],title:"移除连线",class:"remove",onClick:t[1]||(t[1]=t=>e.$emit("remove",e.pathId))},null,8,Tt)])):(0,r.kq)("",!0)],34)}var Ut=(0,r.aZ)({name:"IoPath",props:{pathDArguments:{type:Array,required:!0},pathId:{type:String,required:!0},from:{type:Object,required:!0},to:{type:Object,required:!0}},setup(e){const t=(0,r.Fl)((()=>{const t=e.pathDArguments;return`\nM ${t[0]}, ${t[1]}\nC ${t[2]}, ${t[3]}, ${t[4]}, ${t[5]}, ${t[6]}, ${t[7]}`})),o=(0,a.iH)(null),n=(0,a.iH)(!1),l=(0,r.Fl)((()=>{t.value,n.value;const{x:e,y:r}=o.value?.getPointAtLength(o.value?.getTotalLength()/2)||{x:0,y:0};return[e,r]})),i=e=>{console.log(e)},s=e=>{console.log(e)};return{PATH_STROKE_W:Je,focused:n,pathRef:o,pathD:t,p:l,handlePathClick:i,handlePathBlur:s}}});const jt=(0,qe.Z)(Ut,[["render",At],["__scopeId","data-v-39e4bcf4"]]);var Ht=jt;function Gt(e){const{to:t,from:o}=e;let n=!1;const r=e=>{if(t.vm!==e.vm)for(let t=0;t<e.vm.relativePaths.in.length;t++){if(n)break;const o=e.vm.relativePaths.in[t];r(o.from)}else n=!0};return r(o),n}function Bt(e){const{to:t,from:o}=e,n=t.vm.relativePaths.in.filter((e=>t.attr===e.to.attr&&t.vm===e.to.vm));return n.length>0}function Jt(e){if(e.from.vm===e.to.vm)throw new TypeError("连接了自身");if(e.from.el?.dataset.portType===e.to.el?.dataset.portType)throw new TypeError("端口不兼容");if(Bt(e))throw new TypeError("发生了重复连接");if(Gt(e))throw new TypeError("连接产生了环");console.log(e.to.vm.relativePaths.in[0]?.from.vm.relativePaths.in[0]?.from.vm.relativePaths.in)}async function $t(){return new Promise((e=>{setTimeout((()=>{e(f("savedGraph")?.stuff.nodes??{})}),500)}))}async function qt(){return new Promise((e=>{setTimeout((()=>{e(f("savedGraph")?.stuff.nodeForms??{})}),500)}))}async function Wt(){return new Promise((e=>{setTimeout((()=>{e(f("savedGraph")?.stuff.links??{})}),500)}))}function Lt(){const e=(0,a.XI)(null),t=(0,r.FN)().proxy;let o=new ResizeObserver((([t],o)=>{e.value=t.target.getBoundingClientRect(),console.log(e.value)}));return(0,r.bv)((()=>{o.observe(t.$el),(0,r.Jd)((()=>{o.disconnect()})),o=null})),{elRect:e}}var Zt=(0,r.aZ)({name:"SvgCanvas",components:{IoNode:Mt,IoPath:Ht},setup(){const e=(0,a.XI)();(0,r.JJ)("canvasScrollEl",e);const t=Lt().elRect;(0,r.JJ)(Se,t);const o=(0,r.f3)(y),n=(0,r.f3)(b),l=(0,r.f3)(w),i=(0,r.f3)(m),s=(0,r.f3)(P),d=(0,r.f3)(_),c=(0,r.f3)(C),p=e=>{e&&(c.value[e.nodeId]=e)};(0,r.Xn)((()=>{c.value={}}));const f=(0,a.iH)([0,0,0,0,0,0,0,0]),v=(0,r.Fl)((()=>{const e=f.value;return`\nM ${e[0]}, ${e[1]}\nC ${e[2]}, ${e[3]}, ${e[4]}, ${e[5]}, ${e[6]}, ${e[7]}`})),g=(0,a.iH)(null),I=(0,a.iH)(null);(0,r.JJ)("fromPort",g),(0,r.JJ)("toPort",I);const S=({originEl:o,vm:n})=>{const r=o;g.value={vm:n,attr:o.dataset?.feAttr??"",el:o};const l=[r.getBoundingClientRect().x,r.getBoundingClientRect().y];"in"===Ne(r)&&(f.value=[l[0],l[1]+He,l[0]+Be+He,l[1]+He,l[0]-Be+He,l[1]+He,l[0],l[1]+He].map(((o,n)=>n%2===0?o+e.value.scrollLeft-t.value.left:o+e.value.scrollTop-t.value.top))),"out"===Ne(r)&&(f.value=[l[0]+2*He,l[1]+He,l[0]+Be+He,l[1]+He,l[0]-Be+He,l[1],l[0],l[1]].map(((o,n)=>n%2===0?o+e.value.scrollLeft-t.value.left:o+e.value.scrollTop-t.value.top)))},x=({ev:o,originEl:n})=>{"in"===Ne(n)&&(f.value=[o.pageX,o.pageY,o.pageX+Be,o.pageY,...f.value.slice(4)].map(((o,n)=>n<=3?n%2===0?o+e.value.scrollLeft-t.value.left:o+e.value.scrollTop-t.value.top:o))),"out"===Ne(n)&&(f.value=[...f.value.slice(0,4),o.pageX-Be,o.pageY,o.pageX,o.pageY].map(((o,n)=>n>=4?n%2===0?o+e.value.scrollLeft-t.value.left:o+e.value.scrollTop-t.value.top:o)))},E=({ev:o,originEl:r})=>{const l=o.target,a=[l.getBoundingClientRect().x,l.getBoundingClientRect().y];let i,s=[];"in"===Ne(r)&&(s=[a[0]+2*He,a[1]+He,a[0]+Be+He,a[1]+He,...f.value.slice(4)].map(((o,n)=>n<=3?n%2===0?o+e.value.scrollLeft-t.value.left:o+e.value.scrollTop-t.value.top:o)),i={pathDArguments:s,id:u(),to:g.value,from:I.value}),"out"===Ne(r)&&(s=[...f.value.slice(0,4),a[0]-Be+He,a[1]+He,a[0],a[1]+He].map(((o,n)=>n>=4?n%2===0?o+e.value.scrollLeft-t.value.left:o+e.value.scrollTop-t.value.top:o)),i={pathDArguments:s,id:u(),from:g.value,to:I.value});try{Jt(i),n(i),"out"===Ne(r)?(d(i,g,I),I.value?.vm?.afterPathConnected?.()):(d(i,I,g),g.value?.vm?.afterPathConnected?.())}catch(c){console.error(c)}g.value=null,I.value=null,f.value.fill(0)},F=()=>{console.log("canceled"),g.value=null,I.value=null,f.value.fill(0)},O=({vm:e,originEl:t,ev:o})=>{I.value={vm:e,attr:o.target?.dataset?.feAttr??"",el:t}},V=o=>{o.out.forEach((o=>{const n=[o.from.el?.getBoundingClientRect().x??0,o.from.el?.getBoundingClientRect().y??0];o.pathDArguments=[n[0]+2*He,n[1]+He,n[0]+Be+He,n[1]+He,...o.pathDArguments.slice(4)].map(((o,n)=>n<=3?n%2===0?o+e.value.scrollLeft-t.value.left:o+e.value.scrollTop-t.value.top:o))})),o.in.forEach((o=>{const n=[o.to.el?.getBoundingClientRect().x??0,o.to.el?.getBoundingClientRect().y??0];o.pathDArguments=[...o.pathDArguments.slice(0,4),n[0]-Be+He,n[1]+He,n[0],n[1]+He].map(((o,n)=>n>=4?n%2===0?o+e.value.scrollLeft-t.value.left:o+e.value.scrollTop-t.value.top:o))}))},M=(0,r.f3)(D),k=(0,r.f3)(N),T=(0,a.iH)([0,0]),A=(0,a.OT)({in:[],out:[]}),U=(0,r.f3)(h),j=async()=>{const[o,l,a]=await Promise.all([$t(),qt(),Wt()]);Object.values(o).forEach((e=>{U(e)})),await(0,r.Y3)(),Object.entries(l).forEach((([e,t],n)=>{Object.keys(t).forEach((n=>{[(0,R.RI)(c.value[e].nodeConfigRef.feAttrValue,n),"feMerge"===o[e].is].includes(!0)&&(c.value[e].nodeConfigRef.feAttrValue[n]=t[n])}))})),await(0,r.Y3)(),Object.values(a).map((o=>{const n=window.structuredClone(o);n.from.vm=c.value[o.from.vmId],n.from.el=n.from.vm.$el.querySelector(`[data-fe-attr="${o.from.attr}"]`);const r=[n.from.el.getBoundingClientRect().x,n.from.el.getBoundingClientRect().y];n.to.vm=c.value[o.to.vmId],n.to.el=n.to.vm.$el.querySelector(`[data-fe-attr="${o.to.attr}"]`);const l=[n.to.el.getBoundingClientRect().x,n.to.el.getBoundingClientRect().y];return n.pathDArguments=[r[0]+2*He,r[1]+He,r[0]+Be+He,r[1]+He,l[0]-Be+He,l[1]+He,l[0],l[1]+He].map(((o,n)=>n%2===0?o+e.value.scrollLeft-t.value.left:o+e.value.scrollTop-t.value.top)),n})).forEach((e=>{try{Jt(e),n(e),d(e,e.from,e.to),I.value=e.to,g.value=e.from,e.to.vm?.afterPathConnected?.()}catch(t){console.error(t)}g.value=null,I.value=null}))};return(0,r.bv)((()=>{j()})),{canvasScrollEl:e,svgCanvasRect:t,ghostPathD:v,ghostNodeRef:M,ghostNodeType:k,ghostNodePosition:T,nodes:i,setNodeRefMap:p,linkedPaths:o,handlePortStart:S,handlePortMove:x,handlePortConnect:E,handlePortCancel:F,handleDestinationChange:O,handleNodeMove:V,fromPort:g,toPort:I,defaultRelativePath:A,relativePathMapIndexedByNodeId:s,removePath:l}}});const Yt=(0,qe.Z)(Zt,[["render",B],["__scopeId","data-v-9eac41f4"]]);var Xt=Yt;const Kt={class:"node-library-panel"},zt={class:"menu-list"},Qt=["onMousedown"];function eo(e,t,o,n,l,a){return(0,r.wg)(),(0,r.iD)("div",Kt,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.menuGroup,((t,o)=>((0,r.wg)(),(0,r.iD)("div",{key:o},[(0,r._)("h4",null,(0,R.zw)(e.menuGroup.title),1),(0,r._)("ul",zt,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.children,((t,o)=>((0,r.wg)(),(0,r.iD)("li",{key:o,onMousedown:o=>e.handleIconMousedown(o,t)},(0,R.zw)(t.title),41,Qt)))),128))])])))),128))])}const to=[{title:"组1",children:Object.keys(Ie).map((e=>({title:e})))}];var oo=(0,r.aZ)({name:"NodeLibraryPanel",setup(e,{emit:t}){const o=(0,r.f3)(O),n=(0,r.Fl)((()=>o.value.svgCanvasRect)),l=(0,r.f3)(D),a=(0,r.f3)(N),i=(0,r.f3)(h),s=function(e,t){X(e,{start(e,{originEl:i}){a.value=t.title,(0,r.Y3)((()=>l.value.$emit("update:position",[e.clientX+o.value.$el.scrollLeft-n.value.left,e.clientY+o.value.$el.scrollTop-n.value.top])))},move(e,{originEl:t}){console.log(l.value),l.value.$emit("update:position",[e.clientX+o.value.$el.scrollLeft-n.value.left,e.clientY+o.value.$el.scrollTop-n.value.top])},up(e,{originEl:r}){i({is:t.title,id:u(),position:[e.clientX+o.value.$el.scrollLeft-n.value.left,e.clientY+o.value.$el.scrollTop-n.value.top]}),a.value=null}})};return{handleIconMousedown:s,menuGroup:to,filterLibraryPanelWidth:Ae}}});const no=(0,qe.Z)(oo,[["render",eo],["__scopeId","data-v-0ae2d6c7"]]);var ro=no;const lo={is:"ui-form"};function ao(e,t,o,n,l,a){const i=(0,r.up)("form-item");return(0,r.wg)(),(0,r.iD)("div",{class:"stuff-config-panel",style:(0,R.j5)({width:e.stuffConfigPanelWidth+"px"})},[(0,r._)("form",lo,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.formFieldConfig.ports,((e,t)=>((0,r.wg)(),(0,r.j4)(i,{key:t,schema:e,"field-id":t},null,8,["schema","field-id"])))),128))])],4)}const io=e=>((0,r.dD)("data-v-3f17d8a0"),e=e(),(0,r.Cn)(),e),so={key:0},uo=io((()=>(0,r._)("br",null,null,-1))),co=["value"],po=["min","max"];var fo=(0,r.aZ)({__name:"FormItem",props:{schema:{type:Object},fieldId:{type:String}},setup(e){const t=e,o=(0,r.Fl)((()=>t.fieldId)),[n]=(0,r.f3)(E),l=(0,r.Fl)((()=>(0,a.SU)(n)?.nodeConfigRef?.feAttrValue??{})),i=(0,r.Fl)((()=>(0,a.SU)(n)?.nodeConfigRef?.foreignPortValue??{})),s=(0,r.Fl)((()=>(0,R.RI)((0,a.SU)(i),o.value))),u=(e,t)=>e,d=(0,r.Fl)((()=>({disabled:(0,a.SU)(s),value:(0,a.SU)(s)?u(i.value[(0,a.SU)(o)],(0,a.SU)(o)):l.value[(0,a.SU)(o)],onChange:e=>{e.stopPropagation(),l.value[(0,a.SU)(o)]=e.target.value}})));return(t,n)=>!1!==e.schema?.showInConfigPanel?((0,r.wg)(),(0,r.iD)("div",so,[(0,r._)("label",null,(0,R.zw)((0,a.SU)(o)),1),uo,"text"!==e.schema?.type&&e.schema?.type?"number"===e.schema?.type?((0,r.wg)(),(0,r.iD)(r.HY,{key:1},[Array.isArray(e.schema?.range)?((0,r.wg)(),(0,r.iD)("input",(0,r.dG)({key:0,is:"ui-range",type:"range",min:e.schema.range[0],max:e.schema.range[1]},(0,a.SU)(d)),null,16,po)):((0,r.wg)(),(0,r.iD)("input",(0,r.dG)({key:1,is:"ui-input",type:"number",size:"20"},(0,a.SU)(d)),null,16))],64)):(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[Array.isArray(e.schema?.enum)?((0,r.wg)(),(0,r.iD)("select",(0,r.dG)({key:0,is:"ui-select"},(0,a.SU)(d)),[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.schema.enum,(e=>((0,r.wg)(),(0,r.iD)("option",{key:e&&"object"===typeof e?e.value:e,value:e&&"object"===typeof e?e.value:e},(0,R.zw)(e&&"object"===typeof e?e.label:e),9,co)))),128))],16)):((0,r.wg)(),(0,r.iD)("input",(0,r.dG)({key:1,is:"ui-input",type:"text",size:"20"},(0,a.SU)(d)),null,16))],64))])):(0,r.kq)("",!0)}});const vo=(0,qe.Z)(fo,[["__scopeId","data-v-3f17d8a0"]]);var mo=vo,ho=(0,r.aZ)({name:"StuffConfigPanel",components:{FormItem:mo},setup(e,{emit:t}){const[o]=(0,r.f3)(E),n=(0,r.Fl)((()=>(0,a.SU)(o)&&(0,a.SU)(o)?.is?Ie[(0,a.SU)(o).is]:{}));return{stuffConfigPanelWidth:Ue,focusingNode:o,formFieldConfig:n}}});const go=(0,qe.Z)(ho,[["render",ao],["__scopeId","data-v-157e644c"]]);var yo=go;const Po=e=>((0,r.dD)("data-v-32c96690"),e=e(),(0,r.Cn)(),e),wo={class:"output-preview-panel"},bo=["src"],_o=Po((()=>(0,r._)("div",{class:"output-preview-panel__tools"},null,-1)));function Co(e,t,o,n,l,a){const i=(0,r.up)("filter-def");return(0,r.wg)(),(0,r.iD)("div",wo,[(0,r.Wm)(i,{"filter-el-id":"previewingFilter"}),(0,r._)("div",{style:(0,R.j5)({filter:"url(#previewingFilter)"}),class:"output-preview-panel__image-wrap"},[(0,r._)("img",{src:e.sourceImageSrc},null,8,bo)],4),_o])}const Io={class:"filter-def"},So=["id"];function No(e,t,o,n,l,a){return(0,r.wg)(),(0,r.iD)("div",Io,[((0,r.wg)(),(0,r.iD)("svg",null,[(0,r._)("defs",null,[(0,r._)("filter",{id:e.filterElId},[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.renderOfOrderedAllDescendants,((e,t)=>((0,r.wg)(),(0,r.j4)((0,r.LL)(e),{key:t})))),128))],8,So)])]))])}var Do=(0,r.aZ)({name:"FeDef",props:{filterElId:{type:String}},setup(){const[e]=(0,r.f3)(E),t=(0,r.Fl)((()=>{const t=e.value?e.value.orderedAllDescendants:[];return t.map((e=>()=>e.getVNodeFragment(e)))}));return{focusingNode:e,renderOfOrderedAllDescendants:t}}});const xo=(0,qe.Z)(Do,[["render",No],["__scopeId","data-v-47a0f675"]]);var Eo=xo,Fo=(0,r.aZ)({name:"OutputPreviewPanel",components:{FilterDef:Eo},setup(){const e=(0,a.iH)("./demo/assets/rinkysplash.jpg");return{sourceImageSrc:e}}});const Oo=(0,qe.Z)(Fo,[["render",Co],["__scopeId","data-v-32c96690"]]);var Vo=Oo;const Mo={class:"menu-bar"},ko={style:{textAlign:"left"}},Ro={class:"seg-content menu-entry-list"},To=["onMouseenter","onMouseleave"],Ao={class:"submenu-list",style:{position:"absolute",top:"100%",left:0}},Uo=["onMouseenter","onMouseleave","onClick"],jo={key:0},Ho=(0,r.uE)('<div style="text-align:center;" data-v-a11d8ac0><div class="seg-content" data-v-a11d8ac0> SVG Filter Graph Builder </div></div><div style="text-align:right;" data-v-a11d8ac0><div class="seg-content" data-v-a11d8ac0><a target="_blank" href="https://github.com/gogoend/svg-filter-graph-builder" data-v-a11d8ac0>GitHub</a></div></div>',2);var Go=(0,r.aZ)({__name:"TopMenuBar",setup(e){const t=(0,a.iH)({}),o=e=>{t.value[e]=!0},l=e=>{delete t.value[e]},i=(0,r.f3)(I),s=(0,r.Fl)((()=>[{id:"File",label:"File",subMenu:[{id:"Save",label:"Save",onClick(){i()}}]},{id:"Help",label:"Help",subMenu:[{id:"SVG Filter specification on W3C",label:"SVG Filter specification on W3C",onClick(){window.open("https://www.w3.org/TR/filter-effects-1/")}},{id:"SVG Filter documents on MDN",label:"SVG Filter documents on MDN",onClick(){window.open("https://developer.mozilla.org/en-US/docs/Web/SVG/Element/filter")}},{id:"Hr between spec and contact",type:"hr"},{id:"Issue",label:"Issue",onClick(){window.open("https://github.com/gogoend/svg-filter-graph-builder/issues")}},{id:"Contact @gogoend via mail",label:"Contact @gogoend via mail",onClick(){window.open("mailto:gogoend@qq.com")}}]}]));return(e,i)=>((0,r.wg)(),(0,r.iD)("div",Mo,[(0,r._)("div",ko,[(0,r._)("ul",Ro,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,a.SU)(s),(e=>((0,r.wg)(),(0,r.iD)("li",{key:e.id,class:(0,R.C_)(["menu-entry-item",{"menu-entry-item__active":t.value[e.id]}]),onMouseenter:t=>o(e.id),onMouseleave:t=>l(e.id)},[(0,r._)("div",null,(0,R.zw)(e.label),1),(0,r.wy)((0,r._)("ul",Ao,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.subMenu,(e=>((0,r.wg)(),(0,r.iD)("li",{key:e.id,class:(0,R.C_)(["submenu-item",{"submenu-item--active":t.value[e.id],"submenu-item__is-hr":"hr"===e.type}]),onMouseenter:t=>o(e.id),onMouseleave:t=>l(e.id),onMousedown:i[0]||(i[0]=(0,n.iM)((()=>{}),["prevent"])),onClick:(0,n.iM)((()=>{e.onClick?.(),t.value={}}),["prevent"])},["hr"===e.type?((0,r.wg)(),(0,r.iD)("div",jo)):((0,r.wg)(),(0,r.iD)(r.HY,{key:1},[(0,r.Uk)((0,R.zw)(e.label),1)],64))],42,Uo)))),128))],512),[[n.F8,t.value[e.id]]])],42,To)))),128))])]),Ho]))}});const Bo=(0,qe.Z)(Go,[["__scopeId","data-v-a11d8ac0"]]);var Jo=Bo,$o=(0,r.aZ)({name:"AppMain",components:{TopMenuBar:Jo,SvgCanvas:Xt,NodeLibraryPanel:ro,StuffConfigPanel:yo,OutputPreviewPanel:Vo},setup(){const e=(0,r.f3)(V);return{setSvgCanvasVm:e,filterLibraryPanelWidth:Ae,stuffConfigPanelWidth:Ue,topMenuBarHeight:je}}});const qo=(0,qe.Z)($o,[["render",A],["__scopeId","data-v-36a38600"]]);var Wo=qo,Lo=(0,r.aZ)({name:"App",components:{AppMain:Wo},setup(){k()}});const Zo=(0,qe.Z)(Lo,[["render",l]]);var Yo=Zo,Xo=o(2482);class Ko{constructor(){(0,Xo.Z)(this,"listeners",void 0),this.listeners={}}on(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}once(e,t){e in this.listeners||(this.listeners[e]=[]);const o=(...n)=>{t.call(this,...n),this.off(e,o)};this.listeners[e].push(o)}off(e,t){if(!(e in this.listeners))return;const o=this.listeners[e];if(t){for(let n=0;n<o.length;n++)if(o[n]===t)return void o.splice(n,1)}else o.length=0}emit(e,t){if(!(e in this.listeners))return;const o=this.listeners[e].concat();for(let n=0;n<o.length;n++)o[n].call(this,t)}getListeners(e){return e?this.listeners[e]:this.listeners}}const zo=(0,n.ri)(Yo);zo.config.globalProperties.$eventHub=new Ko,zo.mount("#app")}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,o),l.exports}o.m=e,function(){var e=[];o.O=function(t,n,r,l){if(!n){var a=1/0;for(d=0;d<e.length;d++){n=e[d][0],r=e[d][1],l=e[d][2];for(var i=!0,s=0;s<n.length;s++)(!1&l||a>=l)&&Object.keys(o.O).every((function(e){return o.O[e](n[s])}))?n.splice(s--,1):(i=!1,l<a&&(a=l));if(i){e.splice(d--,1);var u=r();void 0!==u&&(t=u)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[n,r,l]}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,l,a=n[0],i=n[1],s=n[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(s)var d=s(o)}for(t&&t(n);u<a.length;u++)l=a[u],o.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return o.O(d)},n=self["webpackChunkgogoend_node_link_builder"]=self["webpackChunkgogoend_node_link_builder"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(1141)}));n=o.O(n)})();
//# sourceMappingURL=app.4e19133e.js.map